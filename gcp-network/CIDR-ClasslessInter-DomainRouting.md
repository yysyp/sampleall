#### CIDR是“无类域间路由（Classless Inter-Domain Routing）”的缩写，它是一种IP地址分配和路由选择的方法，可以更有效地管理IP地址。CIDR采用更灵活的地址分配方法，通过在IP地址中使用可变长度的前缀，实现更细粒度的地址划分。它可以将一个IP地址块划分为多个子网，每个子网可以拥有不同数量的主机地址。CIDR还可以减少路由表的大小，提高路由选择的效率和速度。
- 传统的IP地址分类采用固定长度的地址前缀来划分网络，分为A、B、C、D、E五类，其中A、B、C三类地址用于主机地址，而D、E两类地址用于特殊用途。这种地址分配方法比较简单，但是却浪费了很多IP地址，并且在路由选择时需要维护大量的路由表，导致路由选择效率低下。
CIDR采用可变长度的地址前缀来划分网络，可以将一个IP地址块划分为多个子网，每个子网可以拥有不同数量的主机地址，更加灵活和高效。CIDR还可以减少路由表的大小，提高路由选择的效率和速度。
  

- CIDR: 255.255.255.0/24 (11111111.11111111.11111111.00000000) 
前面的24个1表示网络地址，后面的8个0表示主机地址。
- [1   1   1   1   1   1   1   1].[00000000].[00000000].[00000000]
- 2^7 2^6 2^5 2^4 2^3 2^2 2^1 2^0
- 128 64  32  16   8   4   2   1  ||  00000000=0  ||  11111111=255
- 10000000 = 128     ||    00000001 = 2^0 = 1
- 11000000 = 192     ||    00000010 = 2^1 = 2
- 11100000 = 224     ||    00000100 = 2^2 = 4
- 11110000 = 240     ||    00001000 = 2^3 = 8
- 11111000 = 248     ||    00010000 = 2^4 = 16
- 11111100 = 252     ||    00100000 = 2^5 = 32
- 11111110 = 254     ||    01000000 = 2^6 = 64
- 11111111 = 255     ||    10000000 = 2^7 = 128
  
- 路由聚合：
  最长前缀匹配(最佳匹配)：使用 CIDR 时，路由表中的每个项目由 "网络前缀" 和 "下一跳地址" 组成。
  在查询路由表时可能会得到不止一个匹配结果。应当从匹配结果中选择具有最长网络前缀的路由，因为网络前缀越长，其地址块越小，因此路由就越具体。
- 路由聚合的优点：减小路由规模，加快路由匹配速度；降低路由更新时的流量开销。
注意：
(1) 划分子网只是把IP地址的主机号这部分进行再划分，而不是改变IP地址原来的网络号。因此，从一个IP地址本身或IP数据报的首部，并无法判断源主机
  或目的主机所连接的网络是否进行了子网划分。
(2) 对传统A,B,C,D,E分类的IPv4地址进行子网划分时，子网号不能为全0或全1。但随着CIDR的广泛使用，现在全0和全1的子网号也可以使用了。
(3) 无论是分类IPv4地址还是CIDR，其子网中的主机号为全0或全1的地址都不能被指派。

- IP地址 = {<网络号>, <主机号>}
- IP地址 = {<网络号>, <子网号>, <主机号>}
- 子网掩码用来表示对原网络中主机号的借位情况。
- 子网掩码是一个与 IP 地址相对应的 32 bit 的二进制串，它由一串 1 和跟随的一串 0 组成。其中，1 对应于 IP 地址中的网络号及子网号，而 0 对应于主机号。计算机只需要将 IP 地址和其对应的子网掩码逐位相 "与" (逻辑 AND 运算)，就可得出相应子网的网络地址。
-- 
例1：192.168.23.35/21计算子网的网络ID、子网掩码、起止IP地址？
  解答: 
  21位网络ID，所以隐码是：11111111.11111111.11111000.00000000 = 255.255.248.0
  网络ID：IP & 隐码=192.168.23.35 & 255.255.248.0=192.168.16.0=11000000.10101000.00010000.00000000
  起止IP: [11000000.10101000.00010][000.00000001] -- [11000000.10101000.00010][111.11111110]
  =192.168.16.1 -- 192.168.23.254
--
例2：192.168.10.14/28，192.168.10.15/28，192.168.10.16/28哪个不是同一网段？
  解答:
  192.168.10.14/28=[11000000.10101000.00001010.0000]1110
  192.168.10.15/28=[11000000.10101000.00001010.0000]1111 -- 非法IP但是还是和第一个同一网段的
  192.168.10.16/28=[11000000.10101000.00001010.0001]0000 -- 不同网段的
-- 
例3：172.168.34.56/20，一共划分为了多少个子网，各子网可以包含多少台主机。
  解答：
  由于:A类网络: 00000000... - 01111111...: 0-127 (8位网络号) (private: 10.0.0.0, look back: 127.*.*.*)
      B类网络: 10000000... - 10111111...: 128-191 (16位网络号) (private: 172.16.0.0-172.31.0.0)
      C类网络: 11000000... - 11011111...: 192-223 (24位网络号) (private: 192.168.0.0-192.168.255.0)
      D类网络: 11100000... - 11101111...: 224-239 (Used for Multicast)
      E类网络: 11110000... - 11111111...: 240-255 (Not Used)
  172.168.34.56/20 即 [10101100.10101000.0010]0010.00111000, 属于B类IP，所以有16位网络号。这里子网划分了
  20位网络号，所以子网号有20-16=4位，所以子网数量为2^4=16种组合(0000变化到1111)，即16个子网。
  由于网络位20，所以主机位32-20=12，所以每个网段的主机数为：2^12 - 2 (除去主机位全0和全1两个IP) = 4094
--
例4：A主机的IP地址为192.168.1.100/24，B主机的IP地址为192.168.2.100/16，请问两个主机可以相互通信吗？
  解答：
  A 192.168.1.100/24 = [11000000.10101000.00000001].01100100
  B 192.168.2.100/16 = [11000000.10101000].00000010.01100100
  在通讯之前，主机首先需要判断目标IP是不是跟自己在一个网段中（因为源主机只知道目标主机的IP地址，并不知道他的子网掩码，
  所以，源主机会将目标IP与自己的子网掩码进行比较，得出一个网络ID）。
  A主机发起通讯：A经过计算，会得出B主机跟自己不在一个网段中，会将将ping包发送给网关（路由器）：目标主机不可到达。
  B主机发起通讯：B经过计算，会得出A主机跟自己在一个网段中，B发出ping包，A可以收到，但是A找不到B：超时。
  通讯是看网络号路由的，所以A不能到B，但是B可以到A。
--  
例5: 211.201.188.199/20；211.201.180.199/20；这两个主机可以通讯吗？
  解答：可以，因为两台机器在同一个网段中，网络ID为：211.201.176.0
  211.201.188.199/20=[11010011.11001001.1011]1100.11000111
  211.201.180.199/20=[11010011.11001001.1011]0100.11000111
  
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

#### IP地址根据网络ID的不同分为5种类型，A类地址、B类地址、C类地址、D类地址和E类地址。

A类：A类IP地址：一个A类IP地址由1字节的网络地址和3字节主机地址组成，网络地址的最高位必须是“0”， 地址范围从1.0.0.0 到126.0.0.0。可用的A类网络有126个，每个网络能容纳1千6百多万个主机。

0 000 0000 - 0 111 1111: 0-127

网络数： 2^7(1~126)（0：用于表示未知地址，127表示回环地址，两个都不能用）= 126

每个网络中的主机数： 2^24-2 = 16777214

注意：主机位全0，表示网络ID，防止发生混淆；

注意：主机位全1表示本网段内的广播地址。所以每个网段中的第一个与最后一个都不能使用。

默认子网掩码： 255.0.0.0
私网地址：10.0.0.0
————————————————

B类：B类IP地址：一个B类IP地址由2个字节的网络地址和2个字节的主机地址组成，网络地址的最高位必须是“10”，地址范围从128.0.0.0到191.255.255.255。可用的B类网络有16382个，每个网络能容纳6万多个主机 。

10 00 0000 - 10 11 1111： 128-191

网络数： 2^14（128~191）= 16384

每个网络中的主机数： 2^16-2 = 65534

默认子网掩码： 255.255.0.0

私网地址： 172.16.0.0-172.31.0.0
————————————————

C类：C类IP地址：一个C类IP地址由3字节的网络地址和1字节的主机地址组成，网络地址的最高位必须是“110”。范围从192.0.0.0到223.255.255.255。C类网络可达209万余个，每个网络能容纳254个主机。

110 0 0000 - 110 1 1111: 192-223

网络数： 2^21（192~223）= 2097152

每个网络中的主机数： 2^8-2 = 254

默认子网掩码： 255.255.255.0

私网地址： 192.168.0.0-192.168.255.0
————————————————

D类：D类地址用于多点广播（Multicast）：D类IP地址第一个字节以“1110”开始，它是一个专门保留的地址。它并不指向特定的网络，目前这一类地址被用在多点广播（Multicast）中。多点广播地址用来一次寻址一组计算机，它标识共享同一协议的一组计算机。224.0.0.0到239.255.255.255用于多点广播 。

1110 0000 - 1110 1111: 224-239

E类：240-255：ping十进制的ip地址也可以ping通。

特殊地址：

（0.0.0.0）地址对应于未知地址。指在本机的路由表里没有特定条目指明如何到达。一般用户主机为了获得一个可用的IP地址，就给DHCP服务器发送IP分组，并用这样的地址作为源地址，目的地址为255.255.255.255（因为主机此时并没有自己的确定的IP地址，防止自己随便定的IP地址与别的主机发生冲突。）。

（255.255.255.255）是当前子网的广播地址。这个地址指本网段内(同一个广播域)的所有主机，该地址用于主机配置过程中IP数据包的目的地址（例如通过DHCP服务器获取本机的IP地址的时候，由于不知道DHCP服务器的IP地址，便会通知数据链路层，发送广播包，来寻找DHCP），这时主机可能还不知道它所在网络的网络掩码，甚至连它的IP地址也还不知道。在任何情况下，路由器都会禁止转发目的地址为受限的广播地址的数据包，这样的数据包仅会出现在本地网络中。

（127.*.*.*）是一个A类地址，但是它已被保留作闭环（look back ），一般用作测试之用而不能分配给一个网络。127中的所有地址都代表发送方自己。

（169.254.*.*）仅限于windows使用，如果你的主机是使用DHCP功能，来自动获得一个IP地址的。那么当你的DHCP服务器发生故障或响应时间太长而超出系统规定的一个时间，Windows系统会为你分配这样一个地址。如果你发现你的 主机IP地址是个诸如此类的地址，很不幸，十有八九是你的网络不能正常运行了，linux没有这种现象。

（私有地址）在IP地址3种主要类型里，各保留了3个区域作为私有地址，其地址范围如下：

A类地址：10.0.0.0～10.255.255.255

B类地址：172.16.0.0～172.31.255.255 （16个B类）

C类地址：192.168.0.0～192.168.255.255

私有地址，这些地址被大量用于企业内部网络中。一些宽带路由器，也往往使用192.168.1.1作为缺省地址。私有网络由于不与外部互连，因而可能使用随意的IP地址。保留这样的地址供其使用是为了避免以后接入公网时引起地址混乱。使用私有地址的私有网络在接入Internet时，要使用地址翻译 (nat)，将私有地址翻译成公用合法地址。在Internet上，这类地址是不能出现的。

（直接广播地址）主机位全为1，网段中的最后一个地址为直接广播地址。主机使用这种地址把一个IP数据报发送到本地网段的所有设备上，路由器会转发这种数据报到特定网络上的所有主机。注意：这个地址在IP数据报中只能作为目的地址。另外，直接广播地址使一个网段中可分配给设备的地址数减少了1个。

（子网中的第一个IP）主机位全为0的地址，用作标识网络ID，一个网段中可分配给设备的地址数会减少1个。

（网络位为0的IP地址）当某个主机向同一网段上的其他主机发送报文时就可以使用这样的地址，分组也不会被路由器转发。比如12.12.12.0/24这个网络中的一台主机12.12.12.2/24在与同一网络中的另一台主12.12.12.8/24通信时，目的地址可以是0.0.0.8。


